package com.nps.AppNps.service;


import com.nps.AppNps.loadProces.CSV;
import com.nps.AppNps.loadProces.CsvToSqlServerCPulseCallBacksExport;
import com.nps.AppNps.loadProces.CsvToSqlServerCPulseInvitationsExport;
import com.nps.AppNps.loadProces.CsvToSqlServerCPulseResponseExport;
import com.opencsv.exceptions.CsvValidationException;
import org.springframework.stereotype.Service;

@Service
public class CPulseServiceimpl implements ICPulseService {
    public void Load_cPulse_Response_Export(String inputFilePath, String outputFilePath) {
        String headerFileout = "Alert_closed_by,Alert_close_time,Alert_description,Alert_reopened,Current_status_of_alert,All_log_notes_combined_if_any,Survey_viewed_on_mobile_device_on_any_page,Surveyid,Property_identifier,Property_name,Email,First_name,Last_name,All_Segments,cNPS_Survey_Program,Fraud_Activity_Description,Fraud_Activity_ID,Fraud_Type,Insurance_Activity_Description,Insurance_Activity_ID,Insurance_Claim_Status,Insurance_Sales_Team,Insurance_Type,Insurance_Post_Sale_and_Claim,Follow_up_Actions,Advisor_Id,Advisor_Name,Interaction_Date_Timestamp,Survey_Type,Account_Type,Activity_Description,Activity_ID,Status_Description,Status_ID,Agent_ID,Employee,Category,Contact_Method,Country,Customer_Platform,Segment,Customer_Country,Customer_Integration,Customer_ID,Gender,Insurance_Flag,Channel_Code,Business_Phone,Home_Phone,Mobile_Phone,Customer_Preferred_Language,Product_Description,Product_Feature_Description,Product_Feature_ID,Product_ID,Product_Code,Reference_ID,Salutation,Survey_Method,Channel,Transit_ID,Transit_Name,Age_Group,What_could_we_do_to_serve_you_better,Translations_What_could_we_do_to_serve_you_better,Retail_Everyday_Banking_Journey_Step,Retail_Help_Advice_Journey_Step,Retail_Journey,Retail_New_Product_Sign_up_Journey_Step,Retail_Product_Renewal_Journey_Step,District_ID,District_Name,Impact_of_Recent_Interaction,Why,Translations_Why,Invitation_Date_Peru_Time,Rapid_Response_Sent,Region_ID,Region_Name,Site_ID,Site_Name,Team_ID,Team_Name,Invitation_Date_EST,Response_Date_EST,Response_Date_Peru_Time,Likelihood_to_Recommend,Interaction_Date,Other_Bank_s_LTR,Advice_Given_Verbatim,How_did_you_receive_this_advice,Other_Advice_Given,Were_you_provided_advice,Agent_OSAT,During_your_recent_interaction_with_the_Contact_Centre_were_your_needs_resolved,Times_Interacted,Insurance_Level_of_effort_to_get_an_answer,Effort,Claim_report,Permission_to_Share,Permission_to_Survey_Reason,Permission_to_Survey,Clarity_in_the_final_answer,Information_received,Process_deadlines,Simplicity_of_the_process,Insurance_Provide_clear_answers,Insurance_Keep_customer_informed,Assistance_received_throughout_the_process,Insurance_Inform_expected_response_times,Empathy,Insurances_offer_Tailor_to_customer_needs,Product_Reason_For_Rating,Contact_Frequency,Other_Comments,Easy_to_understand_advice,Expected_Business,Do_you_know_your_Financial_Advisor,Advisor_Comment,Knowledge,Level_of_Confidence,Good_Listener,Preparation,Empathic_Interaction,Valued_customer,Confidence_Level_Comment,Contact_Frequency2,Ease_of_Contact,Tailored_Advice,Fulfilled_Commitments,Relationship_Drivers_Comment,Flexible_Survey_Length_Chosen,OSAT_Comment,Advisor_OSAT,BanBif,BanBif_LTR,Banco_de_Bogotá,Bancolombia,Banco_Itaú,Banco_Popular,Banco_Popular_LTR,Banco_BHD_Leon,Banco_BHD_Leon_LTR,BBVA,BBVA_LTR,BCP,BCP_LTR,Banco_Promerica,Banco_Promerica_LTR,Banco_de_Reservas,Banco_de_Reservas_LTR,Banco_de_Santa_Cruz,Banco_de_Santa_Cruz_LTR,Banco_de_Chile,Banco_de_Chile_LTR,BCI,BCI_LTR,BICE,BICE_LTR,Itaú,Itaú_LTR,Santander,Santander_LTR,Security,Security_LTR,CIBC,CIBC_LTR,Banco_de_Bogotá_LTR,Bancolombia_LTR,Banco_Itaú_LTR,Davivienda_LTR,Davivienda,First_Citizens,First_Citizens_LTR,Interbank,Interbank_LTR,JMMB,JMMB_LTR,JN,JN_LTR,Other_Financial_Institutions_Comment,NCB,NCB_LTR,Other_Bank,Others,RBC,RBC_LTR,Republic_Bank,Republic_Bank_LTR,Sagicor,Sagicor_LTR,Is_Scotiabank_your_Primary_Bank,Attention_Flag,Attention_Label_Churn_Intent_Flag,Attention_Label_Eroding_Faith_Flag,Attention_Label_Legal_Action_Flag,Attention_Label_positive_opportunity_Flag,Attention_type,Customer_effort_bucket_name,Customer_Effort_Score,Negative_Recognition_Flag,Neutral_Recognition_Flag,Positive_Recognition_Flag,Recognition_Flag,Recognition_sentiment_types,Combined_Topics_and_Sentiments_Tagged_Original,Topics_Tagged_Original,Provider,Retail_Premium_Beyond_Banker_Premium_Relationship_Officer,Quarantine_Rule_to_Exclude_Mortgage,Transaction_Types,Customer_Effort_Bucket,Persona,Customer_reached_via_callback,Customer_Assignment,First_name2,Advice,Advisor_Fulfillment,Ease_of_Process,Journey,Product_Satisfaction,Translations_Product_Reason_For_Rating,Callback_Updated_EST,Sales_Advisor_Satisfaction,Flex,Information,Membership,Sales_Channel_Satisfaction,Product_Acquisition_reason,Product_Satisfaction2,Delivery_Response,Service_Time_Response,Agent_OSAT_Comment,Why_Mortgage_Program,Effective_communication,Scotiabank_provides_advice_to_help_me,Scotiabank_s_Consistent_Services,Relevant_Communication_and_Updates_during_the_COVID_19_crisis,I_Trust_Scotiabank_During_These_Difficult_Times,Effectiveness,What_else_can_we_do_to_improve_your_experience,What_else_can_we_do_to_improve_your_experience_2,What_else_can_we_do_to_improve_your_experience_3,Credit_Card_Benefits,Clarity,Delivery_Satisfaction,Response_times,Simplicity_of_the_process2,Credit_card_Terms_and_conditions,Others_please_specify,Other_please_specify,Competitive_Benefits,Easy_to_use,Establishments_Satisfaction,Flex_Question,Handling_Fee,Effort_Level,Credit_Card_Other_Financial_Institutions,Primary_Card,Redemption_Consultation,Not_Primary_Card_Reasons,Ease_of_contact2,Virtual_Satisfaction,Why_Credit_Card,Flexible_Survey_Length_Chosen2,Why_2,Living_Lens_Feedback_type,Audio_Feedback_for_Why_Comment,Video_Feedback_for_Why_Comment,Why_HVC_Affluent_Primary_Bank,Banco_Azteca,Banco_Azteca_LTR,Banorte,Banorte_LTR,BROU,BROU_LTR,Banco_Estado,Banco_Estado_LTR,Banco_Internacional,Banco_Internacional_LTR,Citibanamex,Citibanamex_LTR,HSBC,HSBC_LTR,Inbursa,Inbursa_LTR,Mi_Banco,Mi_Banco_LTR,Official_responsiveness,Understanding_your_business_needs";


        CSV csvTransformer = new CSV(inputFilePath, outputFilePath, headerFileout);
        csvTransformer.transformCsv();
        CsvToSqlServerCPulseResponseExport CPulse_Response_Export = new CsvToSqlServerCPulseResponseExport();
        CPulse_Response_Export.convertCsvToSqlServer();
    }

    public void Load_cPulse_Invitation_Export(String inputFilePath, String outputFilePath) {
        String headerFileout = "First_name,Last_name,Name,Salutation,Property_name,Property_identifier,Email,Gender,Account_Type,Activity_Description,Activity_ID,Agent_ID,Employee,Business_Phone,Category,Category_Code_Description,Channel_Code,Contact_Method,Country,Customer_ID,Customer_Platform,Survey_viewed_mobile_device,Segment,All_Segments,Home_Phone,Interaction_Date,Mobile_Phone,Customer_Preferred_Language,Product_Code,Product_Description,Product_Feature_Description,Product_Feature_ID,Product_ID,Reference_ID,Status_Description,Status_ID,Survey_Method,Contact_Method_Description,Channel,Channel_Description,Transit_ID,Transit_Name,Agent_Team,Brand,Survey_Type,Response_Date_EST,Invitation_Date_EST,Survey_completed_after_reminder,Survey_Status,Survey_opted_out,Region_Name,District_Name,Region_ID,District_ID,Site_Name,Site_ID,Team_Name,Team_ID,Customer_Country,Customer_Integration,Fraud_Type,Fraud_Activity_ID,Fraud_Activity_Description,Advisor_Name,Advisor_Id,cNPS_Survey_Program,Surveyid,Insurance_Activity_Description,Insurance_Activity_ID,Insurance_Claim_Status,Insurance_Flag,Insurance_PostSale_Claim,Insurance_Sales_Team,Insurance_Type,Age_Group,Retail_Journey,Retail_New_Product_SignUp_Journey_Step,Retail_Everyday_Banking_Journey_Step,Retail_Help_Advice_Journey_Step,Retail_Product_Renewal_Journey_Step,Samplingresultexclusioncausedetail,SurveySpec,RawValueAllSegments,AccountOpenDate,CustomerTenure,MortgageActivityDescription,MortgageActivityID,RetailPremium-BeyondBanker/PremiumRelationshipOfficer,Processingfeedfilename,QuarantineRuletoExcludeMortgage,Surveystatus,CustomerTenureGroup,Journey";
        CSV csvTransformer = new CSV(inputFilePath, outputFilePath, headerFileout);
        csvTransformer.transformCsv();
        CsvToSqlServerCPulseInvitationsExport CPulseInvitationsExport = new CsvToSqlServerCPulseInvitationsExport();
        CPulseInvitationsExport.convertCsvToSqlServer();
    }

    @Override
    public void loadMasive() throws CsvValidationException {
        CsvToSqlServerCPulseResponseExport CPulse_Response_Export = new CsvToSqlServerCPulseResponseExport();
        CPulse_Response_Export.convertCsvToSqlServer();

        CsvToSqlServerCPulseInvitationsExport CPulseInvitationsExport = new CsvToSqlServerCPulseInvitationsExport();
        CPulseInvitationsExport.convertCsvToSqlServer();

        CsvToSqlServerCPulseCallBacksExport CPulseCallBacksExport = new CsvToSqlServerCPulseCallBacksExport();
        CPulseCallBacksExport.convertCsvToSqlServer();
    }

    public void Load_cPulse_Callback_Export(String inputFilePath, String outputFilePath) throws CsvValidationException {
        String headerFileout = "Alertclosedby,Alertclosetime,Alertdescription,Alertreopened,Currentstatusofalert,Alllognotescombinedifany,Surveyviewedonmobiledeviceonanypage,SurveyidforinternaluseegRIlink,Propertyidentifier,Propertyname,Email,Firstname,Lastname,AllSegments,cNPSSurveyProgram,FraudActivityDescription,FraudActivityID,FraudType,InsuranceActivityDescription,InsuranceActivityID,InsuranceClaimStatus,InsuranceSalesTeam,InsuranceType,InsurancePostSaleandClaim,FollowupActions,AdvisorId,AdvisorName,InteractionDateTimestamp,SurveyType,AccountType,ActivityDescription,ActivityID,StatusDescription,StatusID,AgentID,Employee,Category,ContactMethod,Country,CustomerPlatform,Segment,CustomerCountry,CustomerIntegration,CustomerID,Gender,InsuranceFlag,ChannelCode,BusinessPhone,HomePhone,MobilePhone,CustomerPreferredLanguage,ProductDescription,ProductFeatureDescription,ProductFeatureID,ProductID,ProductCode,ReferenceID,Salutation,SurveyMethod,Channel,TransitID,TransitName,AgeGroup,Whatcouldwedotoserveyoubetter,TranslationsWhatcouldwedotoserveyoubetter,RetailEverydayBankingJourneyStep,RetailHelpAdviceJourneyStep,RetailJourney,RetailNewProductSignupJourneyStep,RetailProductRenewalJourneyStep,DistrictID,DistrictName,ImpactofRecentInteraction,Why,TranslationsWhy,InvitationDatePeruTime,RapidResponseSent,RegionID,RegionName,SiteID,SiteName,TeamID,TeamName,InvitationDateEST,ResponseDateEST,ResponseDatePeruTime,LikelihoodtoRecommend,InteractionDate,OtherBankLTR,AdviceGivenVerbatim,Howdidyoureceivethisadvice,OtherAdviceGiven,Wereyouprovidedadvice,AgentOSAT,DuringyourrecentinteractionwiththeContactCentre,wereyourneedsresolved,TimesInteracted,InsuranceLevelofefforttogetananswer,Effort,Claimreport,PermissiontoShare,PermissiontoSurveyReason,PermissiontoSurvey,Clarityinthefinalanswer,Informationreceived,Processdeadlines,Simplicityoftheprocess,InsuranceProvideclearanswers,InsuranceKeepcustomerinformed,Assistancereceivedthroughouttheprocess,InsuranceInformexpectedresponsetimes,Empathy,InsurancesofferTailortocustomerneeds,ProductReasonForRating,ContactFrequency,OtherComments,Easytounderstandadvice,ExpectedBusiness,DoyouknowyourFinancialAdvisor,AdvisorComment,Knowledge,LevelofConfidence,GoodListener,Preparation,EmpathicInteraction,Valuedcustomer,ConfidenceLevelComment,ContactFrequency2,EaseofContact,TailoredAdvice,FulfilledCommitments,RelationshipDriversComment,FlexibleSurveyLengthChosen,OSATComment,AdvisorOSAT,BanBif,BanBifLTR,BancodeBogota,Bancolombia,BancoItau,BancoPopular,BancoPopularLTR,BancoBHDLeon,BancoBHDLeonLTR,BBVA,BBVALTR,BCP,BCPLTR,BancoPromerica,BancoPromericaLTR,BancodeReservas,BancodeReservasLTR,BancodeSantaCruz,BancodeSantaCruzLTR,BancodeChile,BancodeChileLTR,BCI,BCILTR,BICE,BICELTR,Itau,ItauLTR,Santander,SantanderLTR,Security,SecurityLTR,CIBC,CIBCLTR,BancodeBogotaLTR,BancolombiaLTR,BancoItauLTR,DaviviendaLTR,Davivienda,FirstCitizens,FirstCitizensLTR,Interbank,InterbankLTR,JMMB,JMMBLTR,JN,JNLTR,OtherFinancialInstitutionsComment,NCB,NCBLTR,OtherBank,Others,RBC,RBCLTR,RepublicBank,RepublicBankLTR,Sagicor,SagicorLTR,IsScotiabankyourPrimaryBank,AttentionFlag,AttentionLabelChurnIntentFlag,AttentionLabelErodingFaithFlag,AttentionLabelLegalActionFlag,AttentionLabelpositiveopportunityFlag,Attentiontype,Customereffortbucketname,CustomerEffortScore,NegativeRecognitionFlag,NeutralRecognitionFlag,PositiveRecognitionFlag,RecognitionFlag,Recognitionsentimenttypes,CombinedTopicsandSentimentsTaggedOriginal,TopicsTaggedOriginal,Provider,RetailPremiumBeyondBankerPremiumRelationshipOfficer,QuarantineRuletoExcludeMortgage,TransactionTypes,CustomerEffortBucket,Persona,Customerreachedviacallback,CustomerAssignment,Firstname2,Advice,AdvisorFulfillment,EaseofProcess,Journey,ProductSatisfaction,TranslationsProductReasonForRating,CallbackUpdatedEST,SalesAdvisorSatisfaction,Flex,Information,Membership,SalesChannelSatisfaction,ProductAcquisitionreason,ProductSatisfaction2,DeliveryResponse,ServiceTimeResponse,AgentOSATComment,WhyMortgageProgram,Effectivecommunication,Scotiabankprovidesadvicetohelpme,ScotiabankConsistentServices,RelevantCommunicationandUpdatesduringtheCOVID19crisis,ITrustScotiabankDuringTheseDifficultTimes,Effectiveness,Whatelsecanwedotoimproveyourexperience,Whatelsecanwedotoimproveyourexperience1,Whatelsecanwedotoimproveyourexperience2,CreditCardBenefits,Clarity,DeliverySatisfaction,Responsetimes,Simplicityoftheprocess2,CreditcardTermsandconditions,Otherspleasespecify,Other(pleasespecify),CompetitiveBenefits,Easytouse,EstablishmentsSatisfaction,FlexQuestion,HandlingFee,EffortLevel,CreditCardOtherFinancialInstitutions,PrimaryCard,RedemptionConsultation,NotPrimaryCardReasons,EaseofContact2,VirtualSatisfaction,WhyCreditCard,FlexibleSurveyLengthChosen2,Why2,LivingLensFeedbacktype,AudioFeedbackforWhyComment,VideoFeedbackforWhyComment,WhyHVCAffluentPrimaryBank,BancoAzteca,BancoAztecaLTR,Banorte,BanorteLTR,BROU,BROULTR,BancoEstado,BancoEstadoLTR,BancoInternacional,BancoInternacionalLTR,Citibanamex,CitibanamexLTR,HSBC,HSBCLTR,Inbursa,InbursaLTR,MiBanco,MiBancoLTR,Officialresponsiveness,Understandingyourbusinessneeds,ClosureStatus,Outcome,OutcomeNote,Resolution,ResolutionNote,CustomerExperienceTriggers,CustomerExperienceTriggersNote,CustomerReached,CustomerIssueEscalated,CustomerIssuePending,CustomerSuggestions,CoachingComments,AdditionalComments,Numberofcallbacksattempted,TeamOwnerCCC,TeamOwnerDigital,CallbackFormUpdated,CustomerIssueRaised,CustomerSuggestions2,FollowupActionsAndAdditionalComments,BranchRoles,CustomerAtRiskFlag,DoesthiscustomerseematrisktoleavetheBank,Callbackby";
        CSV csvTransformer = new CSV(inputFilePath, outputFilePath, headerFileout);
        csvTransformer.transformCsv();
        CsvToSqlServerCPulseCallBacksExport CPulseCallBacksExport = new CsvToSqlServerCPulseCallBacksExport();
        CPulseCallBacksExport.convertCsvToSqlServer();
    }
}